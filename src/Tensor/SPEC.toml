# Tensor SPEC.toml - Linear Type Tensor Wrapper

[definitions]
module_tensor = "src/Tensor"

# Policy: No implicit resource management
linear_policy = "exactly-once"

[[spec_area]]
name = "Linear Resource Safety"
description = "Core linear type invariants for tensor lifecycle"

[[spec_area.sub_spec]]
name = "Exactly-Once Usage"
specs = [
  "- [REQ_TEN_LIN_001] ${module_tensor} SHALL wrap TensorPtr in opaque Tensor type",
  "- [REQ_TEN_LIN_002] ${module_tensor} SHALL enforce (1 t : Tensor) linear annotation on all tensor arguments",
  "- [REQ_TEN_LIN_003] ${module_tensor} SHALL require explicit free call - NO implicit Drop"
]

[[spec_area.sub_spec]]
id = "Ownership Transfer"
specs = [
  "- [REQ_TEN_OWN_001] ${module_tensor} SHALL return (1 _ : Tensor) for operations preserving tensor",
  "- [REQ_TEN_OWN_002] ${module_tensor} SHALL consume tensor linearly on free operation",
  "- [REQ_TEN_OWN_003] ${module_tensor} SHALL chain operations returning both original and result tensors"
]

[[spec_area]]
name = "Tensor Creation"
description = "Safe tensor allocation with linear guarantees"

[[spec_area.sub_spec]]
name = "From Data"
specs = [
  "- [REQ_TEN_CRE_001] ${module_tensor} SHALL provide makeTensor : List Double -> Shape -> IO (1 t : Tensor)",
  "- [REQ_TEN_CRE_002] ${module_tensor} SHALL provide zeros : Shape -> IO (1 t : Tensor)",
  "- [REQ_TEN_CRE_003] ${module_tensor} SHALL provide ones : Shape -> IO (1 t : Tensor)"
]

[[spec_area]]
name = "Tensor Operations"
description = "Linear operations preserving resource safety"

[[spec_area.sub_spec]]
name = "Inspection"
specs = [
  "- [REQ_TEN_INS_001] ${module_tensor} SHALL provide shape : (1 t : Tensor) -> IO (Shape, 1 t : Tensor)",
  "- [REQ_TEN_INS_002] ${module_tensor} SHALL provide dtype : (1 t : Tensor) -> IO (DType, 1 t : Tensor)",
  "- [REQ_TEN_INS_003] ${module_tensor} SHALL provide print : (1 t : Tensor) -> IO (1 t : Tensor)"
]

[[spec_area.sub_spec]]
id = "Destruction"
specs = [
  "- [REQ_TEN_DES_001] ${module_tensor} SHALL provide free : (1 t : Tensor) -> IO ()",
  "- [REQ_TEN_DES_002] ${module_tensor} SHALL guarantee no tensor leak if free is called"
]

[[end]]
